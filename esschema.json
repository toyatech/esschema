{
  "$schema": "http://json-schema.org/schema#",
  "definitions": {
    "Node": {
      "type": "object",
      "properties": {
        "type": { "type": "string" },
        "loc": {
          "oneOf": [
            { "$ref": "#/definitions/SourceLocation" },
            { "type": "null" }
          ]
        }
      },
      "required": [ "type" ]
    },
    "SourceLocation": {
      "type": "object",
      "properties": {
        "source": {
          "oneOf": [
            { "type": "string" },
            { "type": "null" }
          ]
        },
        "start": {
          "allOf": [
            { "$ref": "#/definitions/Position" }
          ]
        },
        "end": {
          "allOf": [
            { "$ref": "#/definitions/Position" }
          ]
        }
      }
    },
    "Position": {
      "type": "object",
      "properties": {
        "line": { "type": "integer", "minimum": 1 },
        "column": { "type": "integer", "minimum": 0 }
      }
    },
    "Program": {
      "type": "object",
      "allOf": [
        { "$ref": "#/definitions/Node" }
      ],
      "properties": {
        "type": { "type": "string", "pattern": "^Program$" },
        "body": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Statement"
          }
        }
      }
    },
    "_Statement": {
      "type": "object",
      "allOf": [
        { "$ref": "#/definitions/Node" }
      ]
    },
    "Statement": {
      "type": "object",
      "oneOf": [
        { "$ref": "#/definitions/Declaration" }
      ]
    },
    "_Declaration": {
      "type": "object",
      "allOf": [
        { "$ref": "#/definitions/Node" }
      ]
    },
    "Declaration": {
      "type": "object",
      "oneOf": [
        { "$ref": "#/definitions/VariableDeclaration" }
      ]
    },
    "VariableDeclaration": {
      "type": "object",
      "allOf": [
        { "$ref": "#/definitions/_Declaration" }
      ],
      "properties": {
        "type": { "type": "string", "pattern": "^VariableDeclaration$" },
        "declarations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/VariableDeclarator"
          }
        },
        "kind": {
          "enum": [ "var", "let", "const" ]
        }
      }
    },
    "VariableDeclarator": {
      "type": "object",
      "allOf": [
        { "$ref": "#/definitions/Node" }
      ],
      "properties": {
        "type": { "type": "string", "pattern": "^VariableDeclarator$" },
        "id": { "$ref": "#/definitions/Pattern" },
        "init": { 
          "oneOf": [
            { "$ref": "#/definitions/Expression" },
            { "type": "null" }
          ]
        }
      }
    },
    "_Expression": {
      "allOf": [
        { "$ref": "#/definitions/Node" }
      ]
    },
    "Expression": {
      "type": "object",
      "oneOf": [
        { "$ref": "#/definitions/BinaryExpression" },
        { "$ref": "#/definitions/Literal" }
      ]
    },
    "BinaryExpression": {
      "type": "object",
      "allOf": [
        { "$ref": "#/definitions/_Expression" }
      ],
      "properties": {
        "type": { "type": "string", "pattern": "^BinaryExpression$" },
        "operator": {
          "$ref": "#/definitions/BinaryOperator"
        },
        "left": { "$ref": "#/definitions/Expression" },
        "right": { "$ref": "#/definitions/Expression" }
      }
    },
    "_Pattern": {
      "allOf": [
        { "$ref": "#/definitions/Node" }
      ]
    },
    "Pattern": {
      "type": "object",
      "oneOf": [
        { "$ref": "#/definitions/Identifier" }
      ]
    },
    "Identifier": {
      "type": "object",
      "allOf": [
        { "$ref": "#/definitions/Node" },
        { "$ref": "#/definitions/_Expression" },
        { "$ref": "#/definitions/_Pattern" }
      ],
      "properties": {
        "type": { "type": "string", "pattern": "^Identifier$" },
        "name": { "type": "string" }
      }
    },
    "Literal": {
      "type": "object",
      "allOf": [
        { "$ref": "#/definitions/Node" },
        { "$ref": "#/definitions/_Expression" }
      ],
      "properties": {
        "type": { "type": "string", "pattern": "^Literal$" },
        "value": {
          "oneOf": [
            { "type": "string" },
            { "type": "boolean" },
            { "type": "null" },
            { "type": "number" },
            { "type": "RegExp" }
          ]
        },
        "raw": {
          "type": "string"
        }
      }
    },
    "BinaryOperator": {
      "enum": [ 
        "==" , "!=" , "===" , "!==" , "<" , "<=" , ">" , ">=", "<<", ">>", 
        ">>>", "+" , "-" , "*" , "/" , "%" , "|" , "^" , "&" , "in", 
        "instanceof", ".."
      ]
    }
  },
  "type": "object",
  "allOf": [
    { "$ref": "#/definitions/Program" }
  ]
}
